## GPA
**Summary:** This module performs Generalized Procrustes Analysis (GPA) with or without scaling shape configurations to unit size, conducts principle component analysis (PCA) of GPA aligned shape coordinates, provides graphical output of GPA results and real-time 3D visualization of PC warps either using the landmarks of mean shape, or using a reference model that is transformed into the mean shape. Visualization of 3D shape deformation of the reference model can be exported as video clips. The input into the module is a folder path containing a number of landmark files stored in Slicerâ€™s fcsv format and optionally a 3D model and accompanying set of landmarks to be used as reference model in 3D visualization of PCA results.

### USAGE
#### Setup analysis: 
This section of the module runs the GPA and PCA analysis on a directory of landmark files. For data sets with a large number of landmarks, please expect running this step to take several minutes.

* __Landmark folder:__ Use landmarkfolder field to select the directory containing `.fcsv` files to be analyzed. There should be one `.fcsv` file per subject. 

* __Output directory prefix:__ Use the output directory field to select the directory where the results will be written. Each time the `GPA` module is run, and new, timestamped results folder is created in this directory to prevent results from being overwritten. Please ensure that you have write access to the directory selected.

* __Exclude landmarks:__ Optionally, landmarks can be excluded from analysis. Please enter the number of each landmark to exclude, seperated by commas (example: 25,27,29). If all landmarks will be used, this field can be left empty.

#### Load previous analysis
As an alternative to running the GPA and PCA analysis, the module can be used to browse and visulize the results from a previous run of the module.

* __Results directory:__ Use the directory selector to choose the output results folder generated by a previous run of the `GPA` module. This folder name will include a timestamp documenting the date/time of the anlysis.

#### Mean shape plot options
This section provides options for quickly and easily interacting with the display of the Procrustes mean shape without leaving the `GPA` module. If there is a warped display of the mean shape in the second 3D viewer, it will also control the display properties for this model. If a more customized display is needed, more display properties are available in the `Markups` module. 

* __Mean shape visibility:__ Toggle the visibility of the mean shape landmark points.

* __Mean point label visibility:__ Toggle the visibility of the mean shape landmark names.

* __Mean shape color:__ Select a new color for the mean shape landmark points.

* __Mean shape glyph scale:__ Adjust the scale of the mean shape landmark points.

#### Landmark variance plot options
This section creates a visualization of the Procrustes distance variance at each point in mean shape, displayed in the 3D viewer. The visualizations are scaled by the size of the mean shape for visibility, and should be used assess relative, rather than absolute variance. Each landmark point is assigned a unique, randomlu assigned color that is not associated with the magnitude of variance.

* __Ellipse type:__ The variance is plotted as an ellipse at each point with the radius in each dimension corresponding to the amount of variance along that axis.

* __Sphere type:__ The variance is plotted as a sphere at each point with a radius dertermined by the average variance across three dimensions.

* __Point cloud:__ Plots GPA aligned landmark coordinates for the entire data set as a point cloud.

#### PCA scatter plot options
This section creates a 2D scatter plot of the PCA scores for each subject. The menu options are used to select the PC's on each axis, or optionally group subjects using factor data. 

* __X Axis:__

* __Y Axis:__

* __Factor name:__

* __Select factor:__

#### Lollipop plot options

* __Vector one: red__

* __Vector two: green__

* __Vector three: blue__

* __Lollipop 2D projection__

#### Setup interactive visualization

* __Mean shape visualization__

* __3D model visualization__

* __Specify reference model__

* __Specify landmark set for selected model__

#### PCA visualization parameters

* __PC Selector One__

* __PC Selector Two__

#### Create animation of PC warping

* __Start recording__

* __Stop recording__

### TUTORIAL
For more information, please see the [GPA tutorial](https://github.com/SlicerMorph/S_2020/blob/master/Day_3/GPA/GPA.md)






